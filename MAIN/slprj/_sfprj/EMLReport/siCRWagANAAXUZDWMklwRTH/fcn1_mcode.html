<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> fcn(<span class="var type1" id="S2T1U5">Error</span>,<span class="var type1" id="S3T1U6">State</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Inputs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line">    <span class="comment">% Error = Ref - State</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T2:U3"><span class="var type1" id="S4T2U9">x_e</span> = <span class="mxinfo " id="T2:U5"><span class="var type1" id="S2T1U11">Error</span>(1)</span></span>;       <span class="mxinfo " id="T2:U7"><span class="var type1" id="S5T2U15">x_dot_e</span> = <span class="mxinfo " id="T2:U9"><span class="var type1" id="S2T1U17">Error</span>(<span class="mxinfo " id="T2:U11">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T2:U12"><span class="var type1" id="S6T2U21">y_e</span> = <span class="mxinfo " id="T2:U14"><span class="var type1" id="S2T1U23">Error</span>(2)</span></span>;       <span class="mxinfo " id="T2:U16"><span class="var type1" id="S7T2U27">y_dot_e</span> = <span class="mxinfo " id="T2:U18"><span class="var type1" id="S2T1U29">Error</span>(<span class="mxinfo " id="T2:U20">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line">    <span class="mxinfo " id="T2:U21"><span class="var type1" id="S8T2U33">z_e</span> = <span class="mxinfo " id="T2:U23"><span class="var type1" id="S2T1U35">Error</span>(3)</span></span>;       <span class="mxinfo " id="T2:U25"><span class="var type1" id="S9T2U39">z_dot_e</span> = <span class="mxinfo " id="T2:U27"><span class="var type1" id="S2T1U41">Error</span>(<span class="mxinfo " id="T2:U29">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T2:U30"><span class="var type1" id="S10T2U45">phi_e</span>   = <span class="mxinfo " id="T2:U32"><span class="var type1" id="S2T1U47">Error</span>(<span class="mxinfo " id="T2:U34">7</span>)</span></span>;   <span class="mxinfo " id="T2:U35"><span class="var type1" id="S11T2U51">phi_dot_e</span>   = <span class="mxinfo " id="T2:U37"><span class="var type1" id="S2T1U53">Error</span>(<span class="mxinfo " id="T2:U39">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T2:U40"><span class="var type1" id="S12T2U57">theta_e</span> = <span class="mxinfo " id="T2:U42"><span class="var type1" id="S2T1U59">Error</span>(<span class="mxinfo " id="T2:U44">8</span>)</span></span>;   <span class="mxinfo " id="T2:U45"><span class="var type1" id="S13T2U63">theta_dot_e</span> = <span class="mxinfo " id="T2:U47"><span class="var type1" id="S2T1U65">Error</span>(<span class="mxinfo " id="T2:U49">11</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T2:U50"><span class="var type1" id="S14T2U69">psi_e</span>   = <span class="mxinfo " id="T2:U52"><span class="var type1" id="S2T1U71">Error</span>(<span class="mxinfo " id="T2:U54">9</span>)</span></span>;   <span class="mxinfo " id="T2:U55"><span class="var type1" id="S15T2U75">psi_dot_e</span>   = <span class="mxinfo " id="T2:U57"><span class="var type1" id="S2T1U77">Error</span>(<span class="mxinfo " id="T2:U59">12</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="comment">% State</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T2:U60"><span class="var type1" id="S16T2U81">x</span> = <span class="mxinfo " id="T2:U62"><span class="var type1" id="S3T1U83">State</span>(<span class="mxinfo " id="T2:U64">1</span>)</span></span>;       <span class="mxinfo " id="T2:U65"><span class="var type1" id="S17T2U87">x_dot</span> = <span class="mxinfo " id="T2:U67"><span class="var type1" id="S3T1U89">State</span>(<span class="mxinfo " id="T2:U69">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T2:U70"><span class="var type1" id="S18T2U93">y</span> = <span class="mxinfo " id="T2:U72"><span class="var type1" id="S3T1U95">State</span>(<span class="mxinfo " id="T2:U74">2</span>)</span></span>;       <span class="mxinfo " id="T2:U75"><span class="var type1" id="S19T2U99">y_dot</span> = <span class="mxinfo " id="T2:U77"><span class="var type1" id="S3T1U101">State</span>(<span class="mxinfo " id="T2:U79">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T2:U80"><span class="var type1" id="S20T2U105">z</span> = <span class="mxinfo " id="T2:U82"><span class="var type1" id="S3T1U107">State</span>(<span class="mxinfo " id="T2:U84">3</span>)</span></span>;       <span class="mxinfo " id="T2:U85"><span class="var type1" id="S21T2U111">z_dot</span> = <span class="mxinfo " id="T2:U87"><span class="var type1" id="S3T1U113">State</span>(<span class="mxinfo " id="T2:U89">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">    <span class="mxinfo " id="T2:U90"><span class="var type1" id="S22T2U117">phi</span>   = <span class="mxinfo " id="T2:U92"><span class="var type1" id="S3T1U119">State</span>(7)</span></span>;   <span class="mxinfo " id="T2:U94"><span class="var type1" id="S23T2U123">phi_dot</span>   = <span class="mxinfo " id="T2:U96"><span class="var type1" id="S3T1U125">State</span>(<span class="mxinfo " id="T2:U98">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T2:U99"><span class="var type1" id="S24T2U129">theta</span> = <span class="mxinfo " id="T2:U101"><span class="var type1" id="S3T1U131">State</span>(8)</span></span>;   <span class="mxinfo " id="T2:U103"><span class="var type1" id="S25T2U135">theta_dot</span> = <span class="mxinfo " id="T2:U105"><span class="var type1" id="S3T1U137">State</span>(<span class="mxinfo " id="T2:U107">11</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo " id="T2:U108"><span class="var type1" id="S26T2U141">psi</span>   = <span class="mxinfo " id="T2:U110"><span class="var type1" id="S3T1U143">State</span>(9)</span></span>;   <span class="mxinfo " id="T2:U112"><span class="var type1" id="S27T2U147">psi_dot</span>   = <span class="mxinfo " id="T2:U114"><span class="var type1" id="S3T1U149">State</span>(<span class="mxinfo " id="T2:U116">12</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="comment">% Change of base</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">    <span class="comment">% rotation matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T3:U117"><span class="var type1" id="S28T3U153">R</span> = <span class="mxinfo " id="T3:U119">[ <span class="mxinfo " id="T14:U120"><span class="mxinfo " id="T2:U121"><span class="mxinfo " id="T2:U122"><span class="fcn" id="F2N3:B158">c</span>(<span class="var type1" id="S24T2U159">theta</span>)</span>*<span class="mxinfo " id="T2:U124"><span class="fcn" id="F2N3:B161">c</span>(<span class="var type1" id="S26T2U162">psi</span>)</span></span>, <span class="mxinfo " id="T2:U126"><span class="mxinfo " id="T2:U127"><span class="mxinfo " id="T2:U128"><span class="mxinfo " id="T2:U129"><span class="fcn" id="F5N4:B167">s</span>(<span class="var type1" id="S22T2U168">phi</span>)</span>*<span class="mxinfo " id="T2:U131"><span class="fcn" id="F5N4:B170">s</span>(<span class="var type1" id="S24T2U171">theta</span>)</span></span>*<span class="mxinfo " id="T2:U133"><span class="fcn" id="F2N3:B173">c</span>(<span class="var type1" id="S26T2U174">psi</span>)</span></span>-<span class="mxinfo " id="T2:U135"><span class="mxinfo " id="T2:U136"><span class="fcn" id="F2N3:B177">c</span>(<span class="var type1" id="S22T2U178">phi</span>)</span>*<span class="mxinfo " id="T2:U138"><span class="fcn" id="F5N4:B180">s</span>(<span class="var type1" id="S26T2U181">psi</span>)</span></span></span>, <span class="mxinfo " id="T2:U140"><span class="mxinfo " id="T2:U141"><span class="mxinfo " id="T2:U142"><span class="mxinfo " id="T2:U143"><span class="fcn" id="F2N3:B186">c</span>(<span class="var type1" id="S22T2U187">phi</span>)</span>*<span class="mxinfo " id="T2:U145"><span class="fcn" id="F5N4:B189">s</span>(<span class="var type1" id="S24T2U190">theta</span>)</span></span>*<span class="mxinfo " id="T2:U147"><span class="fcn" id="F2N3:B192">c</span>(<span class="var type1" id="S26T2U193">psi</span>)</span></span>+<span class="mxinfo " id="T2:U149"><span class="mxinfo " id="T2:U150"><span class="fcn" id="F5N4:B196">s</span>(<span class="var type1" id="S22T2U197">phi</span>)</span>*<span class="mxinfo " id="T2:U152"><span class="fcn" id="F5N4:B199">s</span>(<span class="var type1" id="S26T2U200">psi</span>)</span></span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T3:U117"><span class="mxinfo " id="T3:U119">          <span class="mxinfo " id="T14:U154"><span class="mxinfo " id="T2:U155"><span class="mxinfo " id="T2:U156"><span class="fcn" id="F2N3:B204">c</span>(<span class="var type1" id="S24T2U205">theta</span>)</span>*<span class="mxinfo " id="T2:U158"><span class="fcn" id="F5N4:B207">s</span>(<span class="var type1" id="S26T2U208">psi</span>)</span></span>, <span class="mxinfo " id="T2:U160"><span class="mxinfo " id="T2:U161"><span class="mxinfo " id="T2:U162"><span class="mxinfo " id="T2:U163"><span class="fcn" id="F5N4:B213">s</span>(<span class="var type1" id="S22T2U214">phi</span>)</span>*<span class="mxinfo " id="T2:U165"><span class="fcn" id="F5N4:B216">s</span>(<span class="var type1" id="S24T2U217">theta</span>)</span></span>*<span class="mxinfo " id="T2:U167"><span class="fcn" id="F5N4:B219">s</span>(<span class="var type1" id="S26T2U220">psi</span>)</span></span>-<span class="mxinfo " id="T2:U169"><span class="mxinfo " id="T2:U170"><span class="fcn" id="F2N3:B223">c</span>(<span class="var type1" id="S22T2U224">phi</span>)</span>*<span class="mxinfo " id="T2:U172"><span class="fcn" id="F2N3:B226">c</span>(<span class="var type1" id="S26T2U227">psi</span>)</span></span></span>, <span class="mxinfo " id="T2:U174"><span class="mxinfo " id="T2:U175"><span class="mxinfo " id="T2:U176"><span class="mxinfo " id="T2:U177"><span class="fcn" id="F2N3:B232">c</span>(<span class="var type1" id="S22T2U233">phi</span>)</span>*<span class="mxinfo " id="T2:U179"><span class="fcn" id="F5N4:B235">s</span>(<span class="var type1" id="S24T2U236">theta</span>)</span></span>*<span class="mxinfo " id="T2:U181"><span class="fcn" id="F5N4:B238">s</span>(<span class="var type1" id="S26T2U239">psi</span>)</span></span>+<span class="mxinfo " id="T2:U183"><span class="mxinfo " id="T2:U184"><span class="fcn" id="F5N4:B242">s</span>(<span class="var type1" id="S22T2U243">phi</span>)</span>*<span class="mxinfo " id="T2:U186"><span class="fcn" id="F2N3:B245">c</span>(<span class="var type1" id="S26T2U246">psi</span>)</span></span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T3:U117"><span class="mxinfo " id="T3:U119">          <span class="mxinfo " id="T14:U188"><span class="mxinfo " id="T2:U189">-<span class="mxinfo " id="T2:U190"><span class="fcn" id="F5N4:B250">s</span>(<span class="var type1" id="S24T2U251">theta</span>)</span></span>,       <span class="mxinfo " id="T2:U192"><span class="mxinfo " id="T2:U193"><span class="fcn" id="F5N4:B254">s</span>(<span class="var type1" id="S22T2U255">phi</span>)</span>*<span class="mxinfo " id="T2:U195"><span class="fcn" id="F2N3:B257">c</span>(<span class="var type1" id="S24T2U258">theta</span>)</span></span>,                      <span class="mxinfo " id="T2:U197"><span class="mxinfo " id="T2:U198"><span class="fcn" id="F2N3:B261">c</span>(<span class="var type1" id="S22T2U262">phi</span>)</span>*<span class="mxinfo " id="T2:U200"><span class="fcn" id="F2N3:B264">c</span>(<span class="var type1" id="S24T2U265">theta</span>)</span></span></span>                      ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line">    <span class="mxinfo " id="T4:U202"><span class="var type1" id="S31T4U268">xyz_e_B</span> = <span class="mxinfo " id="T4:U204"><span class="var type1" id="S28T3U270">R</span> * <span class="mxinfo " id="T4:U206">[<span class="var type1" id="S4T2U273">x_e</span>; <span class="var type1" id="S6T2U275">y_e</span>; <span class="var type1" id="S8T2U277">z_e</span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="var type0" id="S18T0U280">y</span> = <span class="message error" id="M1F1C">u</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"></span></span>
</pre>
